>书名：程序是怎样跑起来的<br>
>作者：（日）矢泽久雄<br>
>出版商：ISBN 978-7-115-38513-0，人民邮电出版社<br>
>阅读时间：<br>
>评分：<br>
>感想：<br>
>书摘：<br>
---------------------------------------------------------
>目录：<br>
>第1章  对程序员来说 CPU 是什么<br>
>第2章  数据是用二进制数表示的<br>
>第3章 计算机进行小数运算时出错的原因<br>
>第4章 熟练使用有棱有角的内存<br>
>第5章 内存和磁盘的亲密<br>
>第6章 亲自尝试压缩数据<br>
>第7章 程序是在何种环境中运行的<br>
>第8章 从源文件到可执行文件<br>
>第9章 操作系统和应用的关系<br>
>第10章 通过汇编语言了解程序的实际构成<br>
>第11章 硬件控制方法<br>
>第12章 让计算机“思考”<br>
---------------------------------------------------------



# 第1章  对程序员来说 CPU 是什么

#### 热身问题：
1. 程序是什么？
2. 程序是由什么组成的？
3. 什么是机器语言？
4. 正在运行的程序存储在什么位置？
5. 什么是内存地址？
6. 计算机的构成元件中，负责程序的解释和运行的是哪个？

#### 答案：
1. 指示计算机每一步动作的一组指令
2. 指令和数据
3. CPU 可以直接识别并使用的语言
4. 内存
5. 内存中，用来表示命令和数据存储位置的数值
6. CPU

## 1.1  CPU 的内部结构解析
- 从功能方面来看，CPU 的内部由寄存器、控制器、运算器和时钟四个部分构成，各部分之间由电流信号相互连通。
- 寄存器可用来暂存指令、数据等处理对象，可以将其看作是内存的一种。根据种类的不同，一个 CPU 内部会有20~100个寄存器。
- 控制器负责把内存上的指令、数据等读入寄存器，并根据指令的执行结果来控制整个计算机。
- 运算器负责运算从内存读入寄存器的数据。
- 时钟负责发出 CPU 开始计时的时钟信号。
- 内存通过控制芯片等与 CPU 相连，主要负责存储指令和数据。

## 1.2  CPU 是寄存器的集合体
- 程序是把寄存器作为对象来描述的。
- 程序计数器、累加寄存器、标志寄存器、指令寄存器和栈寄存器都只有一个，其他的寄存器一般有多个。

## 1.3  决定程序流程的程序计数器

## 1.4  条件分支和循环机制
- 程序的流程分为顺序执行、条件分支和循环三种。

## 1.5  函数的调用机制
- 函数的调用需要在完成函数内部的处理后，处理流程再返回到函数调用点（函数调用指令的下一个地址）。
- 机器语言的 call 指令和 return 指令能够解决这个问题。

## 1.6  通过地址和索引实现数组
- 实际地址 = 基址寄存器的值 + 变址寄存器的值

## 1.7  CPU 的处理其实很简单

_表 1-2 机器语言指令的主要类型和功能：_

类型 | 功能
-- | --
数据转送指令 | 寄存器和内存、内存和内存、寄存器和外围设备之间的数据读写操作
运算指令 | 用累加寄存器执行算术运算、逻辑运算、比较运算和移位运算
跳转指令 | 实现条件分支、循环、强制跳转等
call / return 指令 | 函数的调用/返回调用前的地址





# 第2章  数据是用二进制数表示的

#### 热身问题：
1. 32位是几个字节？4字节
2. 二进制数 01011100 转换成十进制数是多少？92
3. 二进制数 00001111 左移两位后，会变成原数的几倍？4倍
4. 补码形式表示的 8 位二进制数 11111111，用十进制数表示的话是多少？
5. 补码形式表示的 8 位二进制数 10101010，用 16 位的二进制数表示的话是多少？
6. 反转部分图形模式时，使用的是什么逻辑运算？

#### 答案：
1. 4字节
2. 92
3. 4倍
4. -1
5. 1111111110101010
6. XOR运算

## 2.1  用二进制数表示计算机信息的原因
- 原因：和 IC（集成电路 Integrated Circuit）的特性很吻合。
- 计算机中处理信息的最小单位是位（bit，binary digit 的缩写），相当于二进制中的一位。
- 计算机所处理的信息的基本单位是 8 位二进制数。8 位二进制数被称为一个字节。字节是最基本的信息计量单位。

## 2.2  什么是二进制数
- 二进制数的值转换成十进制数的值，只需将二进制数的各数位的值和位权相乘，然后将相乘的结果相加即可。

* 机制：
位权（右边数起第一位……）、基数（10 或者 2 等）；
数值 = （位数的数值 x 权位）+ （位数的数值 x 权位）+……

## 2.3  移位运算和乘除运算的关系
- 移位运算：将二进制数值的各数位进行左右移位（shift = 移位）的运算。移位有左移（<< 向高位方向）和右移（>> 向低位方向）两种。

```c
a = 39;
b = a << 2;    //  表示把 a 变量保存的值左移两位
```

- __左移__ 时空出来的低位要进行补 0 操作。
- 二进制数左移后会变成原来的 2 倍、4 倍、8 倍……反之，二进制数右移后则会变成原来的1/2、1/4、1/8……

## 2.4  便于计算机处理的“补数”
- 用来填充右移后空出来的高位的数值。有 0 和 1 两种形式。
- 二进制数中把最高位称为 __符号位__ ，并用其表示正负数。0 为负，1 为正。
- 在表示负数时就需要使用“二进制的补数”，__补数__ 就是用正数来表示负数。
- 获取补数的方法：将二进制数的各数位的数值全部取反，然后再将结果 + 1。

## 2.5  逻辑右移和算术右移的区别
- 逻辑右移：当二进制数的值表示图形模式而非数值时，移位后需要在最高位补 0。
- 算术右移：将二进制数作为带符号的数值进行运算时，移位后要在最高位填充移位前符号位的值（0 或 1）。
- 符号扩充：以 8 位二进制数为例，在保持值不变的前提下将其转换成 16 位和 32 位的二进制数。不管是正数还是用补数表示的负数，都只需用符号位的值（0 或者 1）填充高位即可。

## 2.6 掌握逻辑运算的窍门
- 计算机能处理的运算，大体可分为算术运算和逻辑运算。
- 算术运算是指加减乘除四则运算。
- 逻辑运算时指对二进制数各数字位的 0 和 1 分别进行处理的运算，包括逻辑非（NOT 运算）、逻辑与（AND 运算）、逻辑或（OR 运算）和逻辑异或（XOR[exclusive or] 运算）四种。
- __逻辑非__ 指的是 0 变成1、1 变成 0 的取反操作。
- __逻辑与__ 指的是“两个都是 1”时，运算结果为 1，其他情况下运算结果都为 0 的运算。
- __逻辑或__ 指的是“至少有一方是1”时，运算结果为1，其他情况下运算结果都是 0 的运算。
- __逻辑异或__ 指的是排斥相同数值的运算。当“其中一方是 1，另一方是 0”时运算结果是1，其他情况下结果都是 0。





# 第3章 计算机进行小数运算时出错的原因

#### 热身问题：
1. 二进制数 0.1，用十进制数表示的话是多少？
2. 用小数点后有 3 位的二进制数，能表示十进制数 0.625 吗？
3. 将小数分为符号、尾数、基数、指数 4 部分进行表现的形式称为什么？
4. 二进制数的基数是什么？
5. 通过把 0 作为数值范围的中间值，从而在不使用符号位的情况下来表示负数的表示方法称为什么？
6. 10101100.01010011 这个二进制数，用十六进制数表示的话是多少？

#### 答案：
1. 0.5
2. 能表示
3. 浮点数（浮点数形式）
4. 2
5. EXCESS 系统表现
6. AC.53

## 3.1  将 0.1 累加 100 次也得不到 10

## 3.2 用二进制数表示小数
- 小数点后面部分的位权，第 1 位是 2 的 -1 次幂、第 2 位是 2 的 -2 次幂，以此类推。

## 3.3 计算机运算出错的原因
- 因为有一些十进制数的小数无法转换成二进制数。

## 3.4 什么是浮点数
- 两种表示小数的数据类型：双精度浮点数和单精度浮点数。
- 双精度浮点数类型（double）用 64 位、单精度浮点数类型（float）用 32 位来表示全体小数。都采用浮点数来表示小数。
- 浮点数是指用符号、尾数、基数和指数这四部分来表示的小数。
- 符号部分是指使用一个数据位来表示数值的符号，1 表示负，0 表示“正或者 0”。

## 3.5  正则表达式和 EXCESS 系统
- 在二进制数中，我们使用的是“将小数点前面的值固定为 1 的正则表达式”。
- EXCESS 系统表现是指，通过将指数部分表示范围的中间值设为 0，使得负数不需要用符号来表示。

## 3.6  在实际的程序中进行确认

## 3.7  如何避免计算机计算出错
- 首先是回避策略，即无视这些错误。
- 另一个策略是把小数转换成整数来计算。

## 3.8  二进制数和十六进制数
- 在 C 语言程序中，只需在数值的开头加上 0x 就可以表示十六进制数。
- 二进制数的 4 位，正好相当于十六进制数的 1 位。





# 第4章 熟练使用有棱有角的内存
#### 问题：
1. 有十个地址信号引脚的内存 IC（集成电路）可以指定的地址范围是多少？
2. 高级编程语言中的数据类型表示的是什么？
3. 在 32 位内存地址的环境中，指针变量的长度是多少位？
4. 与物理内存有着相同构造的数组的数据类型长度是多少？
5. 用 LIFO 方式进行数据读写的数据结构称为什么？
6. 根据数据的大小链表分叉成两个方向的数据结构称为什么？

#### 答案：
1. 用二进制数来表示的话是 0000000000~1111111111（用十进制数来表示的话是 0~1023）
2. 占据内存区域的大小和存储在该内存区域的数据类型
3. 32 位
4. 1 字节
5. 栈
6. 二叉查找树（binary search tree）

## 4.1  内存的物理机制很简单
## 4.2  内存的逻辑模型是楼房
## 4.3  简单的指针
## 4.4  数组是高效使用内存的基础
## 4.5  栈、队列以及环形缓冲区
## 4.6  链表使元素的追加和删除更容易
## 4.7  二叉查找树使数据搜索更有效





# 第5章 内存和磁盘的亲密
####  问题：
1.  存储程序方式指的是什么？
2. 通过使用内存来提高磁盘访问速度的机制称为什么？
3. 把磁盘的一部分作为假想内存来使用的机制称为什么？
4. Windows中，在程序运行时，存储着可以动态加载调用的函数和数据的文件称为什么？
5. 在EXE程序文件中，静态加载函数的方式称为什么？
6. 在Windows计算机中，一般磁盘的1个扇区是多少字节？

####  答案：
1. 在存储装置中保存程序，并逐一运行的方式
2. Disk Cache（磁盘缓存）
3. 虚拟内存（virtual memory）
4. DLL（DLL文件）
5. 静态链接
6. 512字节

## 5.1  不读入内存就无法运行
## 5.2  磁盘缓存加快了磁盘访问速度
## 5.3  虚拟内存把磁盘作为部分内存来使用
## 5.4  节约内存的变成方法
1. 通过 DLL 文件实现函数共有
2. 通过调用 `_stdcall` 来减小程序文件的大小
## 5.5  磁盘的物理结构





# 第6章 亲自尝试压缩数据
#### 问题：
1. 文件储存的基本单位是什么？
2. DOC、LZH 和 TXT 这些扩展名中，哪一个是压缩文件的扩展名？
3. 文件内容用“数据的值 x 循环次数”来表示的压缩方法是 RLE 算法还是哈夫曼算法？
4. 在 Windows 计算机经常使用的 SHIFT JIS 字符编码中，1个半角英数是用几个字节的数据来表示的？
5. BMP（BITMAP）格式的图像文件，是压缩过的吗？
6. 可逆压缩和非可逆压缩的不通点是什么？

#### 答案：
1. 1字节（=8位）
2. LZH
3. RLE 算法
4. 1字节（=8位）
5. 没有压缩过
6. 压缩后的数据能复原的是可逆压缩，无法复原的是非可逆压缩

## 6.1  文件以字节为单位保存
## 6.2  RLE 算法的机制
- 把文件内容用“数据 x 重复次数”的形式来表示的压缩方法称为 RLE（Run Length Encoding，行程长度编码）算法。
## 6.3  RLE 算法的缺点
## 6.4  通过莫尔斯编码来看哈夫曼算法的基础
## 6.5 用二叉树实现哈夫曼编码
- 哈夫曼算法是指，为各压缩对象文件分别构造最佳的编码体系，并以该编码体系为基础来进行压缩。
## 6.6  哈夫曼算法能够大幅提升压缩比率
## 6.7  可逆压缩和非可逆压缩
- 能还原到压缩前状态的压缩称为可逆压缩，无法还原到压缩前状态的压缩称为非可逆压缩。





# 第7章 程序是在何种环境中运行的
#### 问题：
1. 应用的运行环境，指的是什么？
2. Macintosh 用的操作系统（MacOS），在 AT 兼容机上能运行吗？
3. Windows 上的应用，在 MacOS 上能运行吗？
4. FreeBSD 提供的 Ports，指的是什么？
5. 在 Macintosh 上可以利用的Windows 环境模拟器称为什么？
6. Java 虚拟机的功能是什么？

#### 答案：
1. 操作系统和计算机本身（硬件）的种类
2. 无法运行
3. 无法运行
4. 通过使用源代码来提供引用，并根据运行环境进行整合编译，从而得以在该环境下运行的机制
5. Virtual PC for Mac
6. 运行 Java 应用的字节代码

## 7.1  运行环境 = 操作系统 + 硬件
## 7.2  Windows 克服了 CPU 以外的硬件差异
## 7.3  不同操作系统的 API 不同
- 程序（本地代码）的运行环境是由操作系统和硬件来决定的。
## 7.4  FreeBSD Port 帮你轻松使用源代码
## 7.5  利用虚拟机获得其他操作系统环境
## 7.6  提供相同运行环境的 Java 虚拟机
## 7.7  BIOS 和引导





# 第8章 从源文件到可执行文件
#### 问题：
1. CPU 可以解析和运行的程序形式称为什么代码？
2. 将多个目标文件结合生成 EXE 文件的工具称为什么？
3. 扩展名为 .obj 的目标文件的内容，是源代码还是本地代码？
4. 把多个目标文件收录在一起的文件称为什么？
5. 仅包含 Windows 的 DLL 文件中存储的函数信息的文件称为什么？
6. 在程序运行时，用来动态申请分配的数据和对象的内存区域形式称为什么？

#### 答案：
1. 本地代码（机器语言代码）
2. 链接器
3. 本地代码
4. 库文件
5. 导入库
6. 堆

## 8.1  计算机只能运行本地代码
## 8.2  本地代码的内容
## 8.3  编译器负责转换源代码
- 因为编译器本身也是程序的一种，所以也需要运行环境。
## 8.4  仅靠编译是无法得到可执行文件的
## 8.5  启动及库文件
## 8.6 DLL 文件及导入库
## 8.7  可执行文件运行时的必要条件
## 8.8  程序加载时会生成栈和堆
- 栈是用来存储函数内部临时使用的变量（局部变量），以及函数调用时所用的参数的内存区域。
- 堆是用来存储程序运行时的任意数据及对象的内存领域。
## 8.9  有点难度的 Q&A





# 第9章 操作系统和应用的关系
#### 问题：
1. 监控程序的主要功能是什么？
2. 在操作系统上运行的程序称为什么？
3. 调用操作系统功能称为什么？
4. Windows Vista 是多少位的操作系统？
5. GUI 是什么的缩写？
6. WYSIWYYG 是什么的缩写？

#### 答案：
1. 程序的加载和运行
2. 应用或应用程序
3. 系统调用（system call）
4. 32位（也有 64位的版本）
5. Graphical User Interface（图形用户界面）
6. What You See Is What You Get（所见即所得）

## 9.1  操作系统功能的历史
## 9.2  要意识到操作系统的存在
## 9.3  系统调用和高级编程语言的移植性
## 9.4  操作系统和高级编程语言使硬件抽象化
## 9.5  Windows 操作系统的特征





# 第10章 通过汇编语言了解程序的实际构成
####  问题：
1. 本地代码的指令中，表示其功能的英语缩写称为什么？
2. 会变远的源代码转换成本地代码的方式称为什么？
3. 本地代码转换成汇编语言的源代码的方式称为什么？
4. 汇编语言的源文件的扩展名，通常是什么格式？
5. 汇编语言程序中的段定义指的是什么？
6. 汇编语言的跳转指令，是在何种情况下使用的？

#### 答案：
1. 助记符
2. 汇编
3. 反汇编
4. asm
5. 构成程序的命令和数据的集合组
6. 将程序流程跳转到其他地址时需要用到该指令

## 10.1  汇编语言和本地代码是一一对应的
使用助记符的编程语言称为汇编语言。
## 10.2  通过编译器输出汇编语言的源代码
## 10.3  不会转换成本地代码的伪指令
## 10.4  汇编语言的语法使“操作码 + 操作数”
- 例如：`move a, b`
## 10.5  最常用的 mov 指令
## 10.6  对栈进行 push 和 pop
## 10.7  函数调用机制
## 10.8  函数内部的处理
## 10.9  始终确保全局变量用的内存空间
## 10.10  临时确保局部变量用的内存空间
## 10.11  循环处理的实现方法
- 在汇编语言的源代码中，循环是通过比较指令（cmp）和跳转指令（jl）来实现的。
## 10.12  条件分支的实现方法
## 10.13  了解程序运行方式的必要性





# 第11章 硬件控制方法
#### 问题：
1. 在汇编语言中，是用什么指令来同外围设备进行输入输出操作的？
2. I/O 是什么的缩写？
3. 用来识别外围设备的编号称为什么？
4. IRQ 是什么的缩写？
5. DMA 是什么的缩写？
6. 用来识别具有 DMA 功能的外围设备的编号称为什么？

#### 答案：
1. IN 指令和 OUT 指令
2. Input/Output
3. I/O 地址或 I/O 端口号
4. Interrupt Request
5. Direct Memory Access
6. DMA 通道

## 11.1  应用和硬件无关？
## 11.2  支撑硬件输入输出的 IN 指令和 OUT 指令
## 11.3  编写测试用的输入输出程序
## 11.4  外围设备的中断请求
## 11.5  用中断来实现实时处理
## 11.6  DMA 可以实现短时间内传送大量数据
## 11.7  文字及图片的显示机制





# 第12章 让计算机“思考”
#### 问题：
1. 用计算机进行的模拟试验称为什么？
2. 伪随机数指的是什么？
3. 随机数的种子指的什么？
4. 计算机有思考功能吗？
5. 计算机有记忆功能吗？
6. AI 是什么的缩写？

#### 答案：
1. 计算机模拟
2. 通过公式产生的伪随机数
3. 生成伪随机数的公式中使用的参数
4. 没有
5. 有
6. Artificial Intelligence

## 12.1  作为“工具”的程序和为了“思考”的程序
## 12.2  用程序来表示人类的思考方式
## 12.3  用程序来表示人类的思考习惯
## 12.4  程序生成随机数的方法
## 12.5  活用记忆功能以达到更接近人类的判断
## 12.6  用程序来表示人类的思考方式





# 附录 让我们开始C语言之旅
- C语言的特点
- 变量和函数
- 数据类型
- 函数调用
- 局部变量和全局变量
- 数组和循环
- 其他语法结构
