>书名：程序是怎样跑起来的<br>
>作者：（日）矢泽久雄<br>
>出版商：ISBN 978-7-115-38513-0，人民邮电出版社<br>
>阅读时间：<br>
>评分：<br>
>感想：<br>
>书摘：<br>

>目录：<br>
>第1章  对程序员来说 CPU 是什么<br>
>第2章  数据是用二进制数表示的<br>
>第3章 计算机进行小数运算时出错的原因<br>
>第4章 熟练使用有棱有角的内存<br>
>第5章 内存和磁盘的亲密<br>
>第6章 亲自尝试压缩数据<br>
>第7章 程序是在何种环境中运行的<br>
>第8章 从源文件到可执行文件<br>
>第9章 操作系统和应用的关系<br>
>第10章 通过汇编语言了解程序的实际构成<br>
>第11章 硬件控制方法<br>
>第12章 让计算机“思考”<br>
---------------------------------------------------------



# 第1章  对程序员来说 CPU 是什么

#### 热身问题：
1. 程序是什么？
2. 程序是由什么组成的？
3. 什么是机器语言？
4. 正在运行的程序存储在什么位置？
5. 什么是内存地址？
6. 计算机的构成元件中，负责程序的解释和运行的是哪个？

#### 答案：
1. 指示计算机每一步动作的一组指令
2. 指令和数据
3. CPU 可以直接识别并使用的语言
4. 内存
5. 内存中，用来表示命令和数据存储位置的数值
6. CPU

## 1.1  CPU 的内部结构解析
- 从功能方面来看，CPU 的内部由寄存器、控制器、运算器和时钟四个部分构成，各部分之间由电流信号相互连通。
- 寄存器可用来暂存指令、数据等处理对象，可以将其看作是内存的一种。根据种类的不同，一个 CPU 内部会有20~100个寄存器。
- 控制器负责把内存上的指令、数据等读入寄存器，并根据指令的执行结果来控制整个计算机。
- 运算器负责运算从内存读入寄存器的数据。
- 时钟负责发出 CPU 开始计时的时钟信号。
- 内存通过控制芯片等与 CPU 相连，主要负责存储指令和数据。

## 1.2  CPU 是寄存器的集合体
- 程序是把寄存器作为对象来描述的。
- 程序计数器、累加寄存器、标志寄存器、指令寄存器和栈寄存器都只有一个，其他的寄存器一般有多个。

## 1.3  决定程序流程的程序计数器

## 1.4  条件分支和循环机制
- 程序的流程分为顺序执行、条件分支和循环三种。

## 1.5  函数的调用机制
- 函数的调用需要在完成函数内部的处理后，处理流程再返回到函数调用点（函数调用指令的下一个地址）。
- 机器语言的 call 指令和 return 指令能够解决这个问题。

## 1.6  通过地址和索引实现数组
- 实际地址 = 基址寄存器的值 + 变址寄存器的值

## 1.7  CPU 的处理其实很简单

_表 1-2 机器语言指令的主要类型和功能：_

类型 | 功能
-- | --
数据转送指令 | 寄存器和内存、内存和内存、寄存器和外围设备之间的数据读写操作
运算指令 | 用累加寄存器执行算术运算、逻辑运算、比较运算和移位运算
跳转指令 | 实现条件分支、循环、强制跳转等
call / return 指令 | 函数的调用/返回调用前的地址





# 第2章  数据是用二进制数表示的

#### 热身问题：
1. 32位是几个字节？4字节
2. 二进制数 01011100 转换成十进制数是多少？92
3. 二进制数 00001111 左移两位后，会变成原数的几倍？4倍
4. 补码形式表示的 8 位二进制数 11111111，用十进制数表示的话是多少？
5. 补码形式表示的 8 位二进制数 10101010，用 16 位的二进制数表示的话是多少？
6. 反转部分图形模式时，使用的是什么逻辑运算？

#### 答案：
1. 4字节
2. 92
3. 4倍
4. -1
5. 1111111110101010
6. XOR运算

## 2.1  用二进制数表示计算机信息的原因
- 原因：和 IC（集成电路 Integrated Circuit）的特性很吻合。
- 计算机中处理信息的最小单位是位（bit，binary digit 的缩写），相当于二进制中的一位。
- 计算机所处理的信息的基本单位是 8 位二进制数。8 位二进制数被称为一个字节。字节是最基本的信息计量单位。

## 2.2  什么是二进制数
- 二进制数的值转换成十进制数的值，只需将二进制数的各数位的值和位权相乘，然后将相乘的结果相加即可。

- 机制：
    * 位权（右边数起第一位……）、基数（10 或者 2 等），
    * 数值 = （位数的数值 x 权位）+ （位数的数值 x 权位）+……

## 2.3  移位运算和乘除运算的关系
- 移位运算：将二进制数值的各数位进行左右移位（shift = 移位）的运算。移位有左移（<< 向高位方向）和右移（>> 向低位方向）两种。

```c
a = 39;
b = a << 2;    //  表示把 a 变量保存的值左移两位
```

- __左移__ 时空出来的低位要进行补 0 操作。
- 二进制数左移后会变成原来的 2 倍、4 倍、8 倍……反之，二进制数右移后则会变成原来的1/2、1/4、1/8……

## 2.4  便于计算机处理的“补数”
- 用来填充右移后空出来的高位的数值。有 0 和 1 两种形式。
- 二进制数中把最高位称为 __符号位__ ，并用其表示正负数。0 为负，1 为正。
- 在表示负数时就需要使用“二进制的补数”，__补数__ 就是用正数来表示负数。
- 获取补数的方法：将二进制数的各数位的数值全部取反，然后再将结果 + 1。

## 2.5  逻辑右移和算术右移的区别
- 逻辑右移：当二进制数的值表示图形模式而非数值时，移位后需要在最高位补 0。
- 算术右移：将二进制数作为带符号的数值进行运算时，移位后要在最高位填充移位前符号位的值（0 或 1）。
- 符号扩充：以 8 位二进制数为例，在保持值不变的前提下将其转换成 16 位和 32 位的二进制数。不管是正数还是用补数表示的负数，都只需用符号位的值（0 或者 1）填充高位即可。

## 2.6 掌握逻辑运算的窍门
- 计算机能处理的运算，大体可分为算术运算和逻辑运算。
- 算术运算是指加减乘除四则运算。
- 逻辑运算时指对二进制数各数字位的 0 和 1 分别进行处理的运算，包括逻辑非（NOT 运算）、逻辑与（AND 运算）、逻辑或（OR 运算）和逻辑异或（XOR[exclusive or] 运算）四种。
- __逻辑非__ 指的是 0 变成1、1 变成 0 的取反操作。
- __逻辑与__ 指的是“两个都是 1”时，运算结果为 1，其他情况下运算结果都为 0 的运算。
- __逻辑或__ 指的是“至少有一方是1”时，运算结果为1，其他情况下运算结果都是 0 的运算。
- __逻辑异或__ 指的是排斥相同数值的运算。当“其中一方是 1，另一方是 0”时运算结果是1，其他情况下结果都是 0。





# 第3章 计算机进行小数运算时出错的原因

#### 热身问题：
1. 二进制数 0.1，用十进制数表示的话是多少？
2. 用小数点后有 3 位的二进制数，能表示十进制数 0.625 吗？
3. 将小数分为符号、尾数、基数、指数 4 部分进行表现的形式称为什么？
4. 二进制数的基数是什么？
5. 通过把 0 作为数值范围的中间值，从而在不使用符号位的情况下来表示负数的表示方法称为什么？
6. 10101100.01010011 这个二进制数，用十六进制数表示的话是多少？

#### 答案：
1. 0.5
2. 能表示
3. 浮点数（浮点数形式）
4. 2
5. EXCESS 系统表现
6. AC.53

## 3.1  将 0.1 累加 100 次也得不到 10

## 3.2 用二进制数表示小数
- 小数点后面部分的位权，第 1 位是 2 的 -1 次幂、第 2 位是 2 的 -2 次幂，以此类推。

## 3.3 计算机运算出错的原因
- 因为有一些十进制数的小数无法转换成二进制数。

## 3.4 什么是浮点数
- 两种表示小数的数据类型：双精度浮点数和单精度浮点数。
- 双精度浮点数类型（double）用 64 位、单精度浮点数类型（float）用 32 位来表示全体小数。都采用浮点数来表示小数。
- 浮点数是指用符号、尾数、基数和指数这四部分来表示的小数。
- 符号部分是指使用一个数据位来表示数值的符号，1 表示负，0 表示“正或者 0”。

## 3.5  正则表达式和 EXCESS 系统
- 在二进制数中，我们使用的是“将小数点前面的值固定为 1 的正则表达式”。
- EXCESS 系统表现是指，通过将指数部分表示范围的中间值设为 0，使得负数不需要用符号来表示。

## 3.6  在实际的程序中进行确认

## 3.7  如何避免计算机计算出错
- 首先是回避策略，即无视这些错误。
- 另一个策略是把小数转换成整数来计算。

## 3.8  二进制数和十六进制数
- 在 C 语言程序中，只需在数值的开头加上 0x 就可以表示十六进制数。
- 二进制数的 4 位，正好相当于十六进制数的 1 位。
